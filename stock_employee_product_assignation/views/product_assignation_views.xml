<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="view_product_assignation_tree" model="ir.ui.view">
            <field name="name">view_product_assignation_tree</field>
            <field name="model">stock.product.assignation</field>
            <field name="arch" type="xml">
                <tree editable="bottom" create="false" decoration-muted="assignation_return == True">
                    <field name="code" attrs="{'readonly': ['|', ('code_readonly', '=', True), ('assignation_return', '=', True)]}"
                           required="True"/>
                    <field name="code_readonly" invisible="1"/>
                    <field name="product_id" readonly="1"/>
                    <field name="employee_id" required="True"
                           attrs="{'readonly': [('assignation_return', '=', True)]}"/>
                    <field name="request_id" readonly="1" optional="hide"/>
                    <field name="move_line_id" readonly="1" optional="hide"/>
                    <field name="start_date" readonly="1"/>
                    <field name="assignation_return" readonly="1" optional="hide"/>
                    <field name="return_move_line_id" readonly="1" optional="hide"/>
                    <field name="end_date" attrs="{'readonly': [('assignation_return', '=', True)]}"/>
                    <field name="observations" attrs="{'readonly': [('assignation_return', '=', True)]}"/>
                    <field name="company_id" groups="base.group_multi_company" readonly="1" optional="hide"/>
                    <button class="text-danger" icon="fa-reply" type="object"
                            name="action_return" string="Return"
                            attrs="{'invisible': [('assignation_return', '=', True)]}"/>
                </tree>
            </field>
        </record>

        <record id="view_product_assignation_search" model="ir.ui.view">
            <field name="name">view_product_assignation_search</field>
            <field name="model">stock.product.assignation</field>
            <field name="arch" type="xml">
                <search>
                    <field name="start_date"/>
                    <field name="end_date"/>
                    <field name="request_id"/>
                    <field name="product_id"/>
                    <field name="employee_id"/>

                    <filter name="group_request" string="Request" context="{'group_by': 'request_id'}"/>
                    <filter name="group_product" string="Product" context="{'group_by': 'product_id'}"/>
                    <filter name="group_employee" string="Employee" context="{'group_by': 'employee_id'}"/>
                    <separator/>
                    <filter name="group_start_date" string="Start date" context="{'group_by': 'start_date'}"/>
                    <filter name="group_end_date" string="End date" context="{'group_by': 'end_date'}"/>
                </search>
            </field>
        </record>

        <record id="action_product_assignation" model="ir.actions.act_window">
            <field name="name">Equipments assignation</field>
            <field name="res_model">stock.product.assignation</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_product_assignation_search"/>
            <field name="context">{'search_default_group_request': 1}</field>
        </record>

        <menuitem id="menu_product_assignation"
                  action="action_product_assignation"
                  parent="stock.menu_stock_inventory_control"
                  sequence="100"/>
    </data>
</odoo>